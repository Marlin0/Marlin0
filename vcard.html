<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>批量生成VCard名片</title>
    <script>
        const btn1_onclick = function (down) {
            let data = document.getElementById('tt').value;
            if (data != "") {
                var content = data.split("\n");
                let r = "";
                for (i = 0; i < content.length; i++) {
                    if (content[i] != "") {
                        var v = content[i].split(",")
                        let name, phone;
                        if (v.length < 2) {
                            name = 10000 + i + 1;
                            phone = v[0];
                        } else {
                            name = v[0];
                            phone = v[1];
                        }
                        r += bindvcard(name, phone);
                    }
                }
                document.getElementById('tted').value = r;
                if (down){
                    download_txt('Contacts.vcf', r)
                }
            }
        }
        
        function bindvcard(name, phone) {
            return "BEGIN:VCARD" +
                "\r\nVERSION:3.0" +
                "\r\nN:;" + name + ";;;" +
                "\r\nFN: " + name +
                "\r\nTEL;TYPE=VOICE,CELL;VALUE=text:" + phone +
                "\r\nEND:VCARD\r\n"
        }
        /**
         * 保存文件
         */
        function download_txt(filename, content, contentType) {
            if (!contentType) contentType = 'application/octet-stream';
            var a = document.createElement('a');
            var blob = new Blob([content], { 'type': contentType });
            a.href = window.URL.createObjectURL(blob);
            a.download = filename;
            a.click();
        }
    </script>
    <style>
        body{
            text-align: center;
        }
        button {
            width: 150px;
            height: 40px;
        }
        div{
            display: inline;
        }
        textarea{
            min-width: 60px;
            
            min-height: 40px;
        }
    </style>
</head>

<body>
    <h1>批量生成VCard名片</h1>
    <p>格式："姓名,手机号码" 也可以不填写姓名只填写手机号码 工具会自动生成姓名 每一行生成一个联系人 </p>
    <button id="btn1" onclick="btn1_onclick()">生成VCard名片 >>></button>
    <button id="btn2" onclick="btn1_onclick(true)">生成并下载</button>
    <p>
        <div>
            <table align="center">
                <td align="left">
                    <table>
                    输入手机号码
                    </table>
                    <table>
                    <textarea id="tt" rows="60" cols="40">
1,123123123
65498713
    </textarea></table>
                </td>
                <td align="left">
                    <div>
                        <table>
                        生成的VCard名片
                    </table>
                        <textarea id="tted" rows="60" cols="40"></textarea>
                    </div>
                </td>
            </table>
    </div>
</body>

</html>
